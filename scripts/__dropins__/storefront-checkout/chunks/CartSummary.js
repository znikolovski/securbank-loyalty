import{classes as b}from"@dropins/tools/lib.js";import{u as V,H as A}from"./ToggleButton.js";import{Card as T,Skeleton as _,SkeletonRow as I,CartItemSkeleton as p,Divider as O,Accordion as z,AccordionSection as H,Icon as N,CartItem as $,Image as P,Price as S}from"@dropins/tools/components.js";import"@dropins/tools/preact-hooks.js";import{m as Q,i as R,T as W,z as F}from"./getStoreConfig.js";import"@dropins/tools/event-bus.js";/* empty css                     */import{jsx as a,jsxs as o,Fragment as g}from"@dropins/tools/preact-jsx-runtime.js";import{S as j}from"./cart-item.js";import*as v from"@dropins/tools/preact-compat.js";import{useState as q,useCallback as M,useMemo as B}from"@dropins/tools/preact-compat.js";import{useText as w,Text as f}from"@dropins/tools/i18n.js";function G(n){window.location.href=n}const x=n=>v.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},v.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),v.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.75 5.88423V4.75H12.25V5.88423L12.0485 13.0713H11.9515L11.75 5.88423ZM11.7994 18.25V16.9868H12.2253V18.25H11.7994Z",stroke:"currentColor"})),X=()=>a(T,{children:o(_,{"data-testid":"cart-summary-skeleton",className:"checkout-cart-summary-skeleton",style:{gridTemplateColumns:"1fr"},children:[a(I,{variant:"heading",fullWidth:!0,size:"medium"}),a(p,{}),a(p,{}),a(p,{}),a(p,{}),a(p,{}),a(I,{size:"medium",fullWidth:!0})]})}),Z=()=>a(_,{"data-testid":"cart-summary-skeleton",className:"checkout-mobile-cart-summary-skeleton",style:{gridTemplateColumns:"1fr"},children:a(I,{fullWidth:!0,size:"xlarge"})}),D=({type:n,onClick:e,children:c})=>o(g,{children:[a(O,{className:"checkout-cart-summary__divider-bottom",variant:"primary"}),a("button",{"data-testid":`action-${n}`,className:"checkout-cart-summary__action",onClick:e,children:c})]}),U=({title:n,isLoading:e,totalQuantity:c,routeCart:t,items:r,taxIncluded:i,action:l})=>a(g,{children:e?a(Z,{}):a(z,{actionIconPosition:"left",children:o(H,{title:`${n} (${c})`,secondaryText:(t==null?void 0:t())&&a("a",{href:t==null?void 0:t(),rel:"noreferrer",children:a(f,{id:"Checkout.CartSummary.editCart"})}),children:[r==null?void 0:r.map(s=>a(E,{item:s,taxIncluded:i},s==null?void 0:s.uid)),l]})})}),J=({title:n,isLoading:e,totalQuantity:c,routeCart:t,items:r,action:i,taxIncluded:l})=>a(g,{children:e?a(X,{}):o(T,{children:[o("div",{className:"checkout-cart-summary__heading",children:[o(A,{level:2,className:"checkout-cart-summary__title",children:[n," (",c,")"]}),(t==null?void 0:t())&&a("a",{className:"checkout-cart-summary__edit",href:t==null?void 0:t(),rel:"noreferrer",children:a(f,{id:"Checkout.CartSummary.editCart"})})]}),a(O,{className:"checkout-cart-summary__divider-top",variant:"primary"}),a("div",{className:"checkout-cart-summary__items",children:r==null?void 0:r.map(s=>a(E,{item:s,taxIncluded:l},s==null?void 0:s.uid))}),i]})}),K=({className:n,...e})=>{const c=w("Checkout.CartSummary.title").title,t=V();return a("div",{className:b(["checkout-cart-summary",n]),children:t==="small"?a(U,{title:c,...e}):a(J,{title:c,...e})})},E=({className:n,item:e,taxIncluded:c=!1})=>{var u,h;const t=w({Sender:"Checkout.CartSummary.GiftCard.sender",Recipient:"Checkout.CartSummary.GiftCard.recipient",Message:"Checkout.CartSummary.GiftCard.message",Download:"Checkout.CartSummary.Downloadable.download",OutOfStockAlert:"Checkout.OutOfStock.alert",..."links"in e&&e.links?{Files:a(f,{id:"Checkout.CartSummary.Downloadable.files",plural:e.links.length,fields:{count:e.links.length}})}:{}});let r=e.regularPrice,i=e.total;c&&(r=e.priceInclTax,i=e.totalInclTax);const l={..."customizableOptions"in e?e.customizableOptions:{},..."configurableOptions"in e?e.configurableOptions:{},..."links"in e&&e.links?{[t.Files]:e.links.join(", ")}:{},..."senderName"in e&&e.senderName?{[t.Sender]:e.senderName}:{},..."recipientName"in e&&e.recipientName?{[t.Recipient]:e.recipientName}:{},..."senderEmail"in e&&"senderName"in e&&e.senderName&&e.senderEmail?{[t.Sender]:`${e.senderName} (${e.senderEmail})`}:{},..."recipientEmail"in e&&"recipientName"in e&&e.recipientName&&e.recipientEmail?{[t.Recipient]:`${e.recipientName} (${e.recipientEmail})`}:{},..."message"in e&&e.message&&e.message!=""?{[t.Message]:s(e.message,60)}:{}};function s(d,m){return d.length>m?`${d.slice(0,m)}...`:d}const y=e.stockStatus===j.OutOfStock?o("span",{"data-testid":"checkout-cart-item-alert",children:[a(N,{source:x,size:"16"}),t.OutOfStockAlert]}):void 0,k=!y&&e.onlyXLeftInStock?o("span",{"data-testid":"checkout-cart-item-low-inventory",children:[a(N,{source:x,size:"16"}),a(f,{id:"Checkout.OutOfStock.lowInventory",plural:e.onlyXLeftInStock,fields:{count:e.onlyXLeftInStock}})]}):void 0;return a("div",{className:b(["checkout-cart-summary-item",n]),children:a($,{"data-testid":"cart-summary-item",taxIncluded:c,title:a("div",{"data-testid":"product-name",children:e.name}),sku:a("div",{children:e.sku}),quantity:e.quantity,image:a(P,{src:((u=e.image)==null?void 0:u.src)??"",alt:(h=e.image)==null?void 0:h.alt,loading:"lazy",width:"80",height:"80",params:{width:80}}),warning:k,alert:y,configurations:l,price:a(S,{amount:e.regularPrice.value,currency:r.currency,weight:"normal"}),total:o(g,{children:[a(S,{amount:e.regularPrice.value*e.quantity,currency:r.currency,variant:e.discounted?"strikethrough":"default"}),e.discounted&&a(S,{amount:i.value,currency:i.currency,sale:!0})]})},e.uid)})},Y=5,ee={canDisplayMoreItems:!1,hasHiddenItems:!1,isLoading:!0,isTaxIncluded:!1,totalQuantity:0,visibleItems:[]};function ae(n){const{config:e}=Q(),c=e===void 0,t=R.value.data,r=t==null;if(c||r)return ee;const{cartSummaryMaxItems:i,cartSummaryTotalDisplay:l,taxCartDisplay:s}=e,y=l===W.Quantity,k=s.shoppingCartDisplayPrice===F.IncludingTax,{items:u,totalQty:h}=t,d=y?h:u.length,m=n?i:Math.min(i,Y),C=u.length>m,L=u.slice(0,m);return{canDisplayMoreItems:C&&!n&&m!=i,hasHiddenItems:C,isLoading:!1,isTaxIncluded:k,totalQuantity:d,visibleItems:L}}const ye=({routeCart:n,...e})=>{const[c,t]=q(!1),r=w({ViewAll:"Checkout.CartSummary.viewAll",ViewMore:"Checkout.CartSummary.viewMore"}),{canDisplayMoreItems:i,hasHiddenItems:l,isLoading:s,isTaxIncluded:y,visibleItems:k,totalQuantity:u}=ae(c),h=M(()=>{t(!0)},[]),d=M(()=>{n&&G(n())},[n]),m=B(()=>{if(l){if(i)return a(D,{type:"view-more",onClick:h,children:r.ViewMore});if(n)return a(D,{type:"view-all",onClick:d,children:r.ViewAll})}},[l,i,h,r.ViewMore,r.ViewAll,d,n]);return a(K,{...e,action:m,taxIncluded:y,isLoading:s,items:k,routeCart:n,totalQuantity:u})};export{ye as C,ae as u};
//# sourceMappingURL=CartSummary.js.map
