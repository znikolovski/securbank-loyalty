import{classes as R}from"@dropins/tools/lib.js";import"@dropins/tools/event-bus.js";import{r as b}from"./requestPasswordResetEmail.js";import{g,c as l,u as _,T as p,F as x,B as w,S as N}from"./useInLineAlert.js";import{useState as T,useCallback as y}from"@dropins/tools/preact-hooks.js";import{useText as P}from"@dropins/tools/i18n.js";import{InLineAlert as h}from"@dropins/tools/components.js";import{s as D,D as E}from"./simplifyTransformAttributesForm.js";import{jsxs as F,jsx as o}from"@dropins/tools/preact-jsx-runtime.js";const v=({routeSignIn:r,onErrorCallback:e,setActiveComponent:i,handleSetInLineAlertProps:s})=>{const c=P({successPasswordResetEmailNotification:"Auth.Notification.successPasswordResetEmailNotification"}),[m,t]=T(!1),d=y(async n=>{n.preventDefault(),t(!0);const a=g(n.target);if(a&&a.email){const f=await b(a.email);f.success?s==null||s({type:"success",text:c.successPasswordResetEmailNotification.replace("{email}",a.email)}):(e==null||e(f),s==null||s({type:"error",text:f.message}))}t(!1)},[s,e,c.successPasswordResetEmailNotification]),u=y(()=>{if(l(i)){i("signInForm");return}l(r)&&(window.location.href=r())},[i,r]);return{isLoading:m,submitResetPassword:d,redirectToSignInPage:u}},z=({formSize:r="default",routeSignIn:e,setActiveComponent:i,onErrorCallback:s,...c})=>{const m=P({title:"Auth.ResetPasswordForm.title",buttonPrimary:"Auth.ResetPasswordForm.buttonPrimary",buttonSecondary:"Auth.ResetPasswordForm.buttonSecondary"}),{inLineAlertProps:t,handleSetInLineAlertProps:d}=_(),{isLoading:u,submitResetPassword:n,redirectToSignInPage:a}=v({routeSignIn:e,setActiveComponent:i,onErrorCallback:s,handleSetInLineAlertProps:d});return F("div",{...c,className:R(["auth-resetPasswordForm",r]),"data-testid":"resetPasswordForm",children:[o(p,{text:m.title,bottomLine:!1,className:"auth-resetPasswordForm__title"}),t.text?o(h,{className:"auth-resetPasswordForm__notification",type:t.type,variant:"secondary",heading:t.text,icon:t.icon}):null,o(x,{name:"resetPassword_form",className:"auth-resetPasswordForm__form",submitCallback:n,isLoading:u,fieldsConfig:D(E),children:F("div",{className:"auth-resetPasswordForm__buttons",children:[o(w,{type:"button",variant:"tertiary",style:{padding:"0"},icon:o(N,{style:{transform:"rotate(90deg)"}}),buttonText:m.buttonSecondary,enableLoader:!1,onClick:a}),o(w,{type:"submit",buttonText:m.buttonPrimary,variant:"primary",enableLoader:u})]})})]})};export{z as R};
//# sourceMappingURL=ResetPasswordForm.js.map
